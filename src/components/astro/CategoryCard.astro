---
import type { Category } from "../../lib/types";
import { getRelativeLocaleUrl } from "astro:i18n";
import "../../styles/components.css";

interface Props {
    category: Category;
    postCount: number;
    index?: number;
}

const { category, postCount, index = 0 } = Astro.props;
const Icon = category.iconComponent;
const currentLocale = Astro.currentLocale || "en";
const categoryUrl = getRelativeLocaleUrl(currentLocale, `/blog/${category.id}`);

// Localized post count text
const postCountText: Record<string, { singular: string; plural: string }> = {
    en: { singular: "post", plural: "posts" },
    es: { singular: " publicación", plural: " publicaciones" },
};
const postText = postCount === 1 
    ? postCountText[currentLocale]?.singular || "post"
    : postCountText[currentLocale]?.plural || "posts";
---

<a
    href={categoryUrl}
    class={`category-card category-card-${index} block group`}
>
    <article
        class="card bg-base-100 shadow-md hover:shadow-lg border border-base-300/50 rounded-xl overflow-hidden h-full"
    >
        <!-- Icon Header -->
        <div
            class={`p-6 flex items-center justify-center ${category.bgColorClass || "bg-base-200"}`}
        >
            {
                Icon ? (
                    <Icon
                        class="w-10 h-10 text-white"
                        aria-label={category.name}
                    />
                ) : (
                    <span class="text-4xl" aria-label={category.name}>
                        {category.icon}
                    </span>
                )
            }
        </div>

        <!-- Content -->
        <div class="card-body p-6">
            <h3 class="card-title text-lg mb-2">
                {category.name}
            </h3>
            <p class="text-sm text-base-content/60 mb-4">
                {category.description}
            </p>

            <!-- Footer -->
            <div class="flex justify-between items-center text-sm">
                <span class="text-base-content/50">
                    {postCount}{postText}
                </span>
                <span class="text-primary group-hover:underline">
                    {currentLocale === "es" ? "Ver →" : "View →"}
                </span>
            </div>
        </div>
    </article>
</a>
