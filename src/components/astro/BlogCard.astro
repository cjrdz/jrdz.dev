---
import { formatDateShort } from "../../lib/utils";
import { getLocalizedCategoryById } from "../../lib/categories";
import { getRelativeLocaleUrl } from "astro:i18n";
import "../../styles/components.css";

interface Props {
    slug: string;
    title: string;
    description: string;
    pubDate: Date;
    category: string;
    subcategory?: string;
    tags?: string[];
    index?: number;
}

const {
    slug,
    title,
    description,
    pubDate,
    category,
    subcategory,
    tags,
    index = 0,
} = Astro.props;

const currentLocale = Astro.currentLocale || "en";
const categoryData = getLocalizedCategoryById(category, currentLocale);
const blogUrl = getRelativeLocaleUrl(currentLocale, `/blog/${slug}`);
---

<a href={blogUrl} class={`blog-card blog-card-${index} block group`}>
    <article
        class="card bg-base-100 shadow-md hover:shadow-lg border border-base-300/50 rounded-xl h-full"
    >
        <div class="card-body p-6">
            <!-- Category badge -->
            <div class="flex flex-wrap gap-2 mb-3">
                <span class="text-xs font-medium text-primary">
                    {categoryData?.name || category}
                </span>
                {
                    subcategory && (
                        <span class="text-xs text-base-content/50">
                            • {subcategory}
                        </span>
                    )
                }
            </div>

            <!-- Title -->
            <h3
                class="text-lg font-bold leading-tight mb-2 group-hover:text-primary transition-colors"
            >
                {title}
            </h3>

            <!-- Description -->
            <p class="text-sm text-base-content/60 line-clamp-2 mb-4">
                {description}
            </p>

            <!-- Footer -->
            <div
                class="flex justify-between items-center text-xs text-base-content/50 mt-auto"
            >
                <time datetime={pubDate.toISOString()}>
                    {formatDateShort(pubDate)}
                </time>
                <span class="text-primary group-hover:underline"> Read → </span>
            </div>
        </div>
    </article>
</a>
